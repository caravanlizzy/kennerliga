import{W as Ct,Y as Me,k as E,q as w,f as Le,e as Ue,bh as it,ar as rt,aB as $t,x as T,N as je,aE as Tt,bg as Bt,a3 as K,v as ut,h as Ge,bc as Lt,bi as Fe,b as fe,aJ as Ne,ao as nt,d as oe,t as Gt,J as Rt,K as Pt,L as xe,bj as At,bk as Mt,a7 as Z,s as lt,a0 as Nt,bl as ze,B as We,A as le,a2 as ie,o as i,C as N,I as L,a as q,w as y,E as I,av as Et,T as De,a6 as te,a8 as ne,c as G,aa as Y,Q as he,a5 as D,G as me,V as Te,a4 as se,F as be,bm as Ot,bn as ot,aN as Be,_ as ke,bo as Vt,bp as Qt,aP as ct,aQ as dt,aM as jt,bq as Ft,aC as mt,ak as Dt,al as Ut,am as zt,an as Wt,ap as Ht,ax as Kt,R as Yt,S as Jt,U as Xt,H as Zt,br as ea}from"./index.dbdd8b8a.js";import{Q as ta}from"./QResizeObserver.1e22230b.js";import{r as aa,Q as na}from"./QSelect.bfc8b332.js";import{Q as we,e as la,d as st,a as Ee}from"./format.0d4ae905.js";import{_ as oa}from"./KennerSelect.8b4035e2.js";import{_ as sa}from"./KennerButton.9646ba98.js";import{Q as ia}from"./QForm.db90c178.js";import{a as ft}from"./reponsive.255c89c8.js";import{a as ra,Q as vt,b as Oe}from"./QTable.eb6f6865.js";import{_ as ua,u as ca}from"./dialog.a18864cf.js";import"./QList.7090564c.js";import"./QTooltip.ed427b03.js";let da=0;const ma=["click","keydown"],fa={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${da++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function va(e,s,c,n){const a=Ct(it,Me);if(a===Me)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Me;const{proxy:l}=Ge(),g=E(null),k=E(null),m=E(null),O=w(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),o=w(()=>a.currentModel.value===e.name),d=w(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(o.value===!0?" q-tab--active"+(a.tabProps.value.activeClass?" "+a.tabProps.value.activeClass:"")+(a.tabProps.value.activeColor?` text-${a.tabProps.value.activeColor}`:"")+(a.tabProps.value.activeBgColor?` bg-${a.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&a.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||a.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(n!==void 0?n.linkClass.value:"")),v=w(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(a.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),_=w(()=>e.disable===!0||a.hasFocus.value===!0||o.value===!1&&a.hasActiveTab.value===!0?-1:e.tabindex||0);function x(p,b){if(b!==!0&&g.value!==null&&g.value.focus(),e.disable===!0){n!==void 0&&n.hasRouterLink.value===!0&&je(p);return}if(n===void 0){a.updateModel({name:e.name}),c("click",p);return}if(n.hasRouterLink.value===!0){const f=(P={})=>{let A;const t=P.to===void 0||Lt(P.to,e.to)===!0?a.avoidRouteWatcher=Fe():null;return n.navigateToRouterLink(p,{...P,returnRouterError:!0}).catch($=>{A=$}).then($=>{if(t===a.avoidRouteWatcher&&(a.avoidRouteWatcher=!1,A===void 0&&($===void 0||$.message.startsWith("Avoided redundant navigation")===!0)&&a.updateModel({name:e.name})),P.returnRouterError===!0)return A!==void 0?Promise.reject(A):$})};c("click",p,f),p.defaultPrevented!==!0&&f();return}c("click",p)}function u(p){Tt(p,[13,32])?x(p,!0):Bt(p)!==!0&&p.keyCode>=35&&p.keyCode<=40&&p.altKey!==!0&&p.metaKey!==!0&&a.onKbdNavigate(p.keyCode,l.$el)===!0&&je(p),c("keydown",p)}function C(){const p=a.tabProps.value.narrowIndicator,b=[],f=T("div",{ref:m,class:["q-tab__indicator",a.tabProps.value.indicatorClass]});e.icon!==void 0&&b.push(T(K,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&b.push(T("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&b.push(e.alertIcon!==void 0?T(K,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):T("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),p===!0&&b.push(f);const P=[T("div",{class:"q-focus-helper",tabindex:-1,ref:g}),T("div",{class:v.value},ut(s.default,b))];return p===!1&&P.push(f),P}const R={name:w(()=>e.name),rootRef:k,tabIndicatorRef:m,routeData:n};Le(()=>{a.unregisterTab(R)}),Ue(()=>{a.registerTab(R)});function Q(p,b){const f={ref:k,class:d.value,tabindex:_.value,role:"tab","aria-selected":o.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:x,onKeydown:u,...b};return rt(T(p,f,C()),[[$t,O.value]])}return{renderTab:Q,$tabs:a}}var ga=fe({name:"QTab",props:fa,emits:ma,setup(e,{slots:s,emit:c}){const{renderTab:n}=va(e,s,c);return()=>n("div")}});function _a(e,s,c){const n=c===!0?["left","right"]:["top","bottom"];return`absolute-${s===!0?n[0]:n[1]}${e?` text-${e}`:""}`}const ha=["left","center","right","justify"];var ba=fe({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>ha.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:s,emit:c}){const{proxy:n}=Ge(),{$q:a}=n,{registerTick:l}=Ne(),{registerTick:g}=Ne(),{registerTick:k}=Ne(),{registerTimeout:m,removeTimeout:O}=nt(),{registerTimeout:o,removeTimeout:d}=nt(),v=E(null),_=E(null),x=E(e.modelValue),u=E(!1),C=E(!0),R=E(!1),Q=E(!1),p=[],b=E(0),f=E(!1);let P=null,A=null,t;const $=w(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:_a(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),J=w(()=>{const r=b.value,h=x.value;for(let M=0;M<r;M++)if(p[M].name.value===h)return!0;return!1}),ae=w(()=>`q-tabs__content--align-${u.value===!0?"left":Q.value===!0?"justify":e.align}`),B=w(()=>`q-tabs row no-wrap items-center q-tabs--${u.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),j=w(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+ae.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),U=w(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),ee=w(()=>e.vertical!==!0&&a.lang.rtl===!0),ve=w(()=>aa===!1&&ee.value===!0);oe(ee,ye),oe(()=>e.modelValue,r=>{S({name:r,setCurrent:!0,skipEmit:!0})}),oe(()=>e.outsideArrows,H);function S({name:r,setCurrent:h,skipEmit:M}){x.value!==r&&(M!==!0&&e["onUpdate:modelValue"]!==void 0&&c("update:modelValue",r),(h===!0||e["onUpdate:modelValue"]===void 0)&&(Re(x.value,r),x.value=r))}function H(){l(()=>{ge({width:v.value.offsetWidth,height:v.value.offsetHeight})})}function ge(r){if(U.value===void 0||_.value===null)return;const h=r[U.value.container],M=Math.min(_.value[U.value.scroll],Array.prototype.reduce.call(_.value.children,(W,F)=>W+(F[U.value.content]||0),0)),z=h>0&&M>h;u.value=z,z===!0&&g(ye),Q.value=h<parseInt(e.breakpoint,10)}function Re(r,h){const M=r!=null&&r!==""?p.find(W=>W.name.value===r):null,z=h!=null&&h!==""?p.find(W=>W.name.value===h):null;if(M&&z){const W=M.tabIndicatorRef.value,F=z.tabIndicatorRef.value;P!==null&&(clearTimeout(P),P=null),W.style.transition="none",W.style.transform="none",F.style.transition="none",F.style.transform="none";const V=W.getBoundingClientRect(),X=F.getBoundingClientRect();F.style.transform=e.vertical===!0?`translate3d(0,${V.top-X.top}px,0) scale3d(1,${X.height?V.height/X.height:1},1)`:`translate3d(${V.left-X.left}px,0,0) scale3d(${X.width?V.width/X.width:1},1,1)`,k(()=>{P=setTimeout(()=>{P=null,F.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",F.style.transform="none"},70)})}z&&u.value===!0&&pe(z.rootRef.value)}function pe(r){const{left:h,width:M,top:z,height:W}=_.value.getBoundingClientRect(),F=r.getBoundingClientRect();let V=e.vertical===!0?F.top-z:F.left-h;if(V<0){_.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(V),ye();return}V+=e.vertical===!0?F.height-W:F.width-M,V>0&&(_.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(V),ye())}function ye(){const r=_.value;if(r===null)return;const h=r.getBoundingClientRect(),M=e.vertical===!0?r.scrollTop:Math.abs(r.scrollLeft);ee.value===!0?(C.value=Math.ceil(M+h.width)<r.scrollWidth-1,R.value=M>0):(C.value=M>0,R.value=e.vertical===!0?Math.ceil(M+h.height)<r.scrollHeight:Math.ceil(M+h.width)<r.scrollWidth)}function Ke(r){A!==null&&clearInterval(A),A=setInterval(()=>{pt(r)===!0&&ce()},5)}function Ye(){Ke(ve.value===!0?Number.MAX_SAFE_INTEGER:0)}function Je(){Ke(ve.value===!0?0:Number.MAX_SAFE_INTEGER)}function ce(){A!==null&&(clearInterval(A),A=null)}function ht(r,h){const M=Array.prototype.filter.call(_.value.children,X=>X===h||X.matches&&X.matches(".q-tab.q-focusable")===!0),z=M.length;if(z===0)return;if(r===36)return pe(M[0]),M[0].focus(),!0;if(r===35)return pe(M[z-1]),M[z-1].focus(),!0;const W=r===(e.vertical===!0?38:37),F=r===(e.vertical===!0?40:39),V=W===!0?-1:F===!0?1:void 0;if(V!==void 0){const X=ee.value===!0?-1:1,ue=M.indexOf(h)+V*X;return ue>=0&&ue<z&&(pe(M[ue]),M[ue].focus({preventScroll:!0})),!0}}const bt=w(()=>ve.value===!0?{get:r=>Math.abs(r.scrollLeft),set:(r,h)=>{r.scrollLeft=-h}}:e.vertical===!0?{get:r=>r.scrollTop,set:(r,h)=>{r.scrollTop=h}}:{get:r=>r.scrollLeft,set:(r,h)=>{r.scrollLeft=h}});function pt(r){const h=_.value,{get:M,set:z}=bt.value;let W=!1,F=M(h);const V=r<F?-1:1;return F+=V*5,F<0?(W=!0,F=0):(V===-1&&F<=r||V===1&&F>=r)&&(W=!0,F=r),z(h,F),ye(),W}function Xe(r,h){for(const M in r)if(r[M]!==h[M])return!1;return!0}function yt(){let r=null,h={matchedLen:0,queryDiff:9999,hrefLen:0};const M=p.filter(V=>V.routeData!==void 0&&V.routeData.hasRouterLink.value===!0),{hash:z,query:W}=n.$route,F=Object.keys(W).length;for(const V of M){const X=V.routeData.exact.value===!0;if(V.routeData[X===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ue,query:Pe,matched:qt,href:It}=V.routeData.resolvedLink.value,Ae=Object.keys(Pe).length;if(X===!0){if(ue!==z||Ae!==F||Xe(W,Pe)===!1)continue;r=V.name.value;break}if(ue!==""&&ue!==z||Ae!==0&&Xe(Pe,W)===!1)continue;const de={matchedLen:qt.length,queryDiff:F-Ae,hrefLen:It.length-ue.length};if(de.matchedLen>h.matchedLen){r=V.name.value,h=de;continue}else if(de.matchedLen!==h.matchedLen)continue;if(de.queryDiff<h.queryDiff)r=V.name.value,h=de;else if(de.queryDiff!==h.queryDiff)continue;de.hrefLen>h.hrefLen&&(r=V.name.value,h=de)}r===null&&p.some(V=>V.routeData===void 0&&V.name.value===x.value)===!0||S({name:r,setCurrent:!0})}function wt(r){if(O(),f.value!==!0&&v.value!==null&&r.target&&typeof r.target.closest=="function"){const h=r.target.closest(".q-tab");h&&v.value.contains(h)===!0&&(f.value=!0,u.value===!0&&pe(h))}}function xt(){m(()=>{f.value=!1},30)}function Se(){et.avoidRouteWatcher===!1?o(yt):d()}function Ze(){if(t===void 0){const r=oe(()=>n.$route.fullPath,Se);t=()=>{r(),t=void 0}}}function kt(r){p.push(r),b.value++,H(),r.routeData===void 0||n.$route===void 0?o(()=>{if(u.value===!0){const h=x.value,M=h!=null&&h!==""?p.find(z=>z.name.value===h):null;M&&pe(M.rootRef.value)}}):(Ze(),r.routeData.hasRouterLink.value===!0&&Se())}function St(r){p.splice(p.indexOf(r),1),b.value--,H(),t!==void 0&&r.routeData!==void 0&&(p.every(h=>h.routeData===void 0)===!0&&t(),Se())}const et={currentModel:x,tabProps:$,hasFocus:f,hasActiveTab:J,registerTab:kt,unregisterTab:St,verifyRouteModel:Se,updateModel:S,onKbdNavigate:ht,avoidRouteWatcher:!1};Gt(it,et);function tt(){P!==null&&clearTimeout(P),ce(),t!==void 0&&t()}let at;return Le(tt),Rt(()=>{at=t!==void 0,tt()}),Pt(()=>{at===!0&&Ze(),H()}),()=>T("div",{ref:v,class:B.value,role:"tablist",onFocusin:wt,onFocusout:xt},[T(ta,{onResize:ge}),T("div",{ref:_,class:j.value,onScroll:ye},xe(s.default)),T(K,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(C.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||a.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:Ye,onTouchstartPassive:Ye,onMouseupPassive:ce,onMouseleavePassive:ce,onTouchendPassive:ce}),T(K,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(R.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||a.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:Je,onTouchstartPassive:Je,onMouseupPassive:ce,onMouseleavePassive:ce,onTouchendPassive:ce})])}}),gt=fe({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:s}){const c=w(()=>{const n=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(a=>e[a]===!0).map(a=>`q-btn-group--${a}`).join(" ");return`q-btn-group row no-wrap${n.length!==0?" "+n:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>T("div",{class:c.value},xe(s.default))}});const pa=[T("circle",{cx:"50",cy:"50",r:"44",fill:"none","stroke-width":"4","stroke-opacity":".5",stroke:"currentColor"}),T("circle",{cx:"8",cy:"54",r:"6",fill:"currentColor","stroke-width":"3",stroke:"currentColor"},[T("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 48",to:"360 50 52",dur:"2s",repeatCount:"indefinite"})])];var ya=fe({name:"QSpinnerOrbit",props:At,setup(e){const{cSize:s,classes:c}=Mt(e);return()=>T("svg",{class:c.value,width:s.value,height:s.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},pa)}});async function wa(e,s=null){const c={game:e.game,selected_options:e.selected_options};s!==null&&(c.leagueId=s);try{return await Z("/game/selected-games/",{method:"POST",data:c})}catch(n){throw new Error("Error creating selectedGame: "+n)}}async function xa(e){try{return await Z(`/game/options/?game=${e}`)}catch(s){throw new Error(`Error retrieving game options for game with id: ${e} 
 ${s}`)}}async function ka(e){try{return await Z(`/game/option-choices/?option=${e}`)}catch(s){throw new Error(`Error retrieving game option choices for game with id: ${e} 
 ${s}`)}}function Sa(e){const s=lt({game:void 0,options:[]}),c=E(!1),n=E(null),a=E(""),l=E([]),g=E([]),k=w(()=>g.value.filter(t=>(!n.value||t.platform===n.value.id)&&(!a.value||t.name.toLowerCase().includes(a.value.toLowerCase())))),m=async()=>{l.value=await b(),g.value=await f()},o=lt({game:{id:-1,name:"",platform:-1},selectedOptions:[]});async function d(t){s.game&&s.game.id===t.id||(c.value=!0,v(t),await R(t.id),await Q(),c.value=!1)}function v(t){_(t),x(t)}function _(t){s.game=t,s.options=[]}function x(t){o.game=t,o.selectedOptions=[]}function u(t){o.selectedOptions=t.map($=>({id:$.id,selected_game:o.game.id,value:$.has_choices?void 0:!1,choice:void 0}))}function C(t){return o.selectedOptions.find($=>$.id===t)}async function R(t){try{const{data:$}=await xa(t);s.options=$,u($)}catch($){console.error(`Failed to fetch options for game ${t}:`,$),s.options=[]}}async function Q(){for(const t of s.options){if(!t.has_choices)continue;const{data:$}=await ka(t.id);t.choices=[...t.choices||[],...$]}}function p(t){var $;return(($=s.options.find(J=>J.id===t))==null?void 0:$.choices)||null}async function b(){const{data:t}=await Z("game/platforms/");return t}async function f(){const{data:t}=await Z(`game/games/?league=${e.value}&exclude_repeated=true`);return t}function P(t){const $=t.selectedOptions.map(J=>{const ae={selected_game:t.game.id,game_option_id:J.id};return J.choice?{...ae,choice_id:J.choice.id}:{...ae,value:J.value}});return{game:t.game.id,selected_options:$}}function A(){if(o){const t=P(o);return wa(t)}else console.warn("No game selected")}return{gameInformation:s,gameSelection:o,isLoading:c,setGameInformation:d,findChoicesByOption:p,findSelectedOption:C,submitGame:A,platform:n,filter:a,platforms:l,gameData:g,filteredGames:k,loadPlatformsAndGames:m}}async function qa(){try{return(await Z.get("user/me/current-league")).data.id}catch(e){throw console.error(e),e}}async function Ia(e){return await Z.get(`league/league-details/${e}`)}async function _t(e){const s={username:e.username,league:e.leagueId};e.decline&&(s.declined_ban=e.decline),e.gameId&&(s.game=e.gameId);try{return await Z("/game/ban-decisions/",{method:"POST",data:s})}catch(c){throw new Error("Error creating ban decision: "+c)}}const re=Nt("league",()=>{const e=E(null),s=ze(null),c=E([]),n=E("PICKING"),a={PICKING:{noun:"Game Selection Phase",verb:"pick"},REPICKING:{noun:"Game Reselection",verb:"pick again"},BANNING:{noun:"Ban Phase",verb:"ban"},PLAYING:{noun:"Games running"},DONE:{noun:"League finished"}},l=w(()=>{var B,j;return(j=(B=a[n.value])==null?void 0:B.noun)!=null?j:""}),g=w(()=>{var B,j;return(j=(B=a[n.value])==null?void 0:B.verb)!=null?j:""}),k=w(()=>c.value.reduce((B,j)=>(B[j.id]=j,B),{})),m=w(()=>c.value.length?c.value.map(B=>B.selected_game&&{...B.selected_game,selected_by:B.username}).filter(Boolean):[]),O=w(()=>m.value.reduce((B,j)=>(B[j.id]=j,B),{})),o=E({}),d=w(()=>Object.values(o.value).flat()),v=w(()=>m.value.filter(B=>{var j,U;return((U=(j=o.value[B.id])==null?void 0:j.length)!=null?U:0)>0})),_=w(()=>m.value.filter(B=>{var j,U;return((U=(j=o.value[B.id])==null?void 0:j.length)!=null?U:0)===0})),x=E(!1);let u=null;async function C(){if(e.value==null)return;const{data:B}=await Ia(e.value);s.value=B,c.value=B.members,c.value=c.value.map((j,U)=>({...j,colorClass:`bg-player-${U+1}`,color:`color-player-${U+1}`,borderClass:`border-player-${U+1}`})),n.value=B.status}function R(B,j){const U=new Map;j.forEach(ee=>U.set(ee.id,ee)),o.value={...o.value,[B]:Array.from(U.values()).sort((ee,ve)=>{var S,H;return((S=ve.points)!=null?S:0)-((H=ee.points)!=null?H:0)})}}async function Q(){if(e.value==null)return;const B=m.value.map(U=>U.id);if(!B.length)return;const j=B.map(U=>Z.get(`/result/results/?selected_game=${U}`).then(({data:ee})=>R(U,ee)).catch(()=>R(U,[])));await Promise.all(j)}async function p(B){const{data:j}=await Z.get(`/result/results/?selected_game=${B}`);R(B,j)}async function b(){if(!x.value)return u||(u=(async()=>{e.value=await qa(),await C(),await Q(),x.value=!0,u=null})(),u)}const f=w(()=>c.value.find(B=>B.is_active_player)),{isMe:P,user:A}=We(),t=w(()=>f.value?P(f.value.username):!1),$=w(()=>(n.value==="PICKING"||n.value==="REPICKING")&&t.value),J=w(()=>n.value==="BANNING"&&t.value);async function ae(){if(!(!A||!e.value))try{await _t({username:A.username,leagueId:e.value,decline:!0}),await C()}catch(B){console.error(B)}}return{leagueId:e,leagueData:s,members:c,leagueStatus:n,initialized:x,selectedGames:m,matchResults:d,matchResultsByGame:o,activePlayer:f,isMeActivePlayer:t,isMePickingGame:$,isMeBanningGame:J,selectedGamesWithResults:v,selectedGamesFetchedEmpty:_,membersById:k,selectedGamesById:O,statusNoun:l,statusVerb:g,init:b,updateLeagueData:C,banNothing:ae,getMatchResults:Q,refreshResultsForGame:p}}),qe=E([]),Ie=ze(null),Ve=ze(null);function He(){function e(l){const g=Array.isArray(l)?l:[l];qe.value=g.map(k=>({...k,autoReset:k.autoReset===void 0?!0:k.autoReset}))}function s(l){Ie.value=typeof l=="string"?()=>T("div",l):l}function c(l){Ve.value=typeof l=="string"?()=>T("div",l):l}function n(){qe.value=[],Ie.value=null,Ve.value=null}const a=w(()=>Ie.value!==null&&qe.value.length>0);return{actions:qe,leadText:Ie,subject:Ve,setSubject:c,hasContent:a,setActions:e,setLeadText:s,reset:n}}const Ca={class:"column justify-center"},$a={class:"row q-pt-md justify-center",style:{"max-height":"220px","overflow-y":"auto"}},Ta={class:"text-body2 text-weight-bold ellipsis"},Ba={key:0},La={class:"text-h6 text-weight-bold"},Ga=L("div",{class:"text-italic text-grey"}," This game has no additional settings ",-1),Ra=L("div",{class:"text-subtitle2 text-primary q-mb-md"},"Settings",-1),Pa={key:0,class:"q-mb-md"},Aa={class:"row q-col-gutter-md"},Ma={key:1},Na={class:"row q-col-gutter-sm"},Ea=le({__name:"GameSelector",emits:["submit-success"],setup(e,{emit:s}){const{leagueId:c}=ie(re()),{gameInformation:n,gameSelection:a,isLoading:l,setGameInformation:g,findChoicesByOption:k,findSelectedOption:m,submitGame:O,platform:o,filter:d,platforms:v,filteredGames:_,loadPlatformsAndGames:x}=Sa(c),u=s,C=async()=>{try{await O(),u("submit-success")}catch(P){console.error("Error submitting game:",P)}},{setActions:R,setLeadText:Q,setSubject:p}=He();R([{name:"Confirm",callback:C,buttonVariant:"positive"}]),Q(()=>T("div","Confirm your game selection")),oe(a,P=>{P.game&&p(P.game.name)});function b(P){var t;const A=v.value.find($=>$.id===P);return(t=A==null?void 0:A.name)!=null?t:`ID: ${P}`}function f(P){switch(P.toLowerCase()){case"boardgamers.space":return{color:"deep-purple-3",text:"white"};case"yucata":return{color:"blue-5",text:"white"};case"bga":return{color:"green-5",text:"white"};default:return{color:"grey-3",text:"dark"}}}return Ue(x),(P,A)=>(i(),N("div",null,[L("div",Ca,[q(De,{modelValue:I(d),"onUpdate:modelValue":A[0]||(A[0]=t=>Et(d)?d.value=t:null),label:"Spiel",outlined:"",dense:"",clearable:"",class:"rounded-borders col-grow"},{append:y(()=>[q(K,{name:"search"})]),_:1},8,["modelValue"]),q(gt,{spread:"",outline:"",push:"",square:""},{default:y(()=>[(i(!0),N(te,null,ne(I(v)||[],t=>{var $;return i(),G(Te,{key:t.id,color:(($=I(o))==null?void 0:$.id)===t.id?"primary":"white","text-color":f(t.name).color,onClick:J=>{var ae;return o.value=((ae=I(o))==null?void 0:ae.id)===t.id?null:t}},{default:y(()=>[se(Y(t.name),1)]),_:2},1032,["color","text-color","onClick"])}),128))]),_:1})]),L("div",$a,[(i(!0),N(te,null,ne(I(_),t=>(i(),G(me,{key:t.id,onClick:$=>I(g)(t),flat:"",bordered:"",square:"",clickable:"",class:be(["cursor-pointer text-center q-pa-sm transition-all",[t.id===I(a).game.id?"bg-primary text-white shadow-8":"bg-grey-3 text-dark shadow-2 hover-bg-grey-4 hover-shadow-6"]]),style:{width:"130px"}},{default:y(()=>[q(he,{class:"q-pa-sm"},{default:y(()=>[L("div",Ta,Y(t.name.length>13?t.name.slice(0,12)+"\u2026":t.name),1),q(we,{dense:"",square:"",class:"q-mt-xs",color:f(b(t.platform)).color,"text-color":f(b(t.platform)).text},{default:y(()=>[se(Y(b(t.platform).split(".")[0]),1)]),_:2},1032,["color","text-color"])]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),I(l)?(i(),N("div",Ba,[q(ya,{size:"xl"})])):I(n).game?(i(),G(me,{key:1,flat:"",class:"q-pa-md q-my-md"},{default:y(()=>[q(he,null,{default:y(()=>[L("div",La,Y(I(n).game.name),1)]),_:1}),I(n).options.length?(i(),G(he,{key:1},{default:y(()=>[Ra,I(n).options.some(t=>t.has_choices)?(i(),N("div",Pa,[L("div",Aa,[(i(!0),N(te,null,ne(I(n).options.filter(t=>t.has_choices),t=>(i(),N("div",{key:t.id,class:"col-12 col-sm-6 col-md-4"},[q(oa,{options:I(k)(t.id),label:t.name,"option-label":"name",dense:"",outlined:"",modelValue:I(a).selectedOptions.find($=>$.id==t.id).choice,"onUpdate:modelValue":$=>I(a).selectedOptions.find(J=>J.id==t.id).choice=$,class:"full-width"},null,8,["options","label","modelValue","onUpdate:modelValue"])]))),128))])])):D("",!0),I(n).options.some(t=>!t.has_choices)?(i(),N("div",Ma,[L("div",Na,[(i(!0),N(te,null,ne(I(n).options.filter(t=>!t.has_choices),t=>(i(),G(Ot,{key:t.id,modelValue:I(m)(t.id).value,"onUpdate:modelValue":$=>I(m)(t.id).value=$,label:t.name,dense:"",color:"secondary",class:"col-auto"},null,8,["modelValue","onUpdate:modelValue","label"]))),128))])])):D("",!0)]),_:1})):(i(),G(he,{key:0},{default:y(()=>[Ga]),_:1}))]),_:1})):D("",!0)]))}});const Oa={class:"column actionBar radius q-mb-md"},Va={key:0,class:"row items-center justify-between status-line q-py-xs"},Qa={class:"row items-center justify-center col text-subtitle1 text-weight-regular text-italic"},ja={class:"text-bold"},Fa={key:2,class:"row justify-between no-wrap items-center q-py-md q-px-lg"},Da={key:0,class:"text-body2 text-primary"},Ua={key:1,class:"text-body1 text-primary text-weight-bold"},za={class:"row items-center no-wrap q-gutter-sm"},Wa=le({__name:"ActionBar",setup(e){const{actions:s,leadText:c,subject:n,reset:a}=He(),{activePlayer:l,isMeActivePlayer:g}=ie(re());async function k(m){try{m.callback(),m.autoReset&&a()}catch(O){console.error(O)}}return(m,O)=>{var o;return i(),N("div",Oa,[I(l)?(i(),N("div",Va,[L("div",Qa,[L("span",ja,[q(we,{class:be((o=I(l))==null?void 0:o.colorClass),"text-color":"white"},{default:y(()=>{var d;return[se(Y((d=I(l))==null?void 0:d.username),1)]}),_:1},8,["class"]),se("'s turn ")])])])):D("",!0),I(g)?(i(),G(Be,{key:1,inset:""})):D("",!0),I(g)?(i(),N("div",Fa,[I(c)?(i(),N("div",Da,[(i(),G(ot(I(c))))])):D("",!0),I(n)?(i(),N("div",Ua,[(i(),G(ot(I(n))))])):D("",!0),L("div",za,[(i(!0),N(te,null,ne(I(s),d=>(i(),G(sa,{outline:"",color:d.buttonVariant||"primary",key:d.name,onClick:v=>k(d)},{default:y(()=>[se(Y(d.name),1)]),_:2},1032,["color","onClick"]))),128))])])):D("",!0)])}}});var Ha=ke(Wa,[["__scopeId","data-v-1c495a27"]]);const Ka={class:"column"},Ya={class:"text-h5 text-weight-bold text-primary text-center"},Ja=le({__name:"LeagueStatusBar",setup(e){const{statusNoun:s,leagueStatus:c}=ie(re());return(n,a)=>(i(),N("div",Ka,[L("div",Ya,Y(I(s).toUpperCase()),1),I(c)!=="PLAYING"&&I(c)!=="DONE"?(i(),G(Ha,{key:0})):D("",!0)]))}});var Xa=ke(Ja,[["__scopeId","data-v-fad17bc4"]]);const Za=e=>(ct("data-v-538c876c"),e=e(),dt(),e),en={class:"q-pa-md"},tn={class:"row q-col-gutter-md q-mb-xl"},an={class:"q-pa-md q-gutter-md"},nn=Za(()=>L("div",{class:"col"},"Starting position",-1)),ln={class:"col",style:{"margin-top":"0"}},on={class:"row justify-end"},sn=le({__name:"MatchResultForm",props:{selectedGameId:{}},emits:["submitted"],setup(e,{emit:s}){const c=s,n=ft(),a=e,{members:l}=ie(re()),g=E(null),k=E([]),m=E([]),O=E(!1);async function o(){const{data:x}=await Z.get(`game/selected-games/${a.selectedGameId}/`),u=x.game;if(!u){console.warn("Game ID not found");return}const{data:C}=await Z.get(`game/result-configs/?game=${u}`);g.value=C[0]}async function d(){const{data:x}=await Z.get(`game/selected-games/${a.selectedGameId}/`),u=x.game,C=await Z.get(`game/factions/?game=${u}`);k.value=C.data}function v(){m.value=l.value.map(x=>({player_profile:x.id,selected_game:a.selectedGameId,points:null,starting_position:null,faction_id:null,tie_breaker_value:""})),O.value=!1}oe(()=>a.selectedGameId,async()=>{a.selectedGameId&&(await o(),await d(),v())},{immediate:!0});async function _(){var u,C,R,Q,p;m.value=m.value.map(b=>{var f;return{...b,faction_id:b.faction_id!==null&&typeof b.faction_id=="object"&&"id"in b.faction_id?b.faction_id.id:(f=b.faction_id)!=null?f:null}});const x={selected_game:a.selectedGameId,results:m.value};try{(await Z.post("/result/match-results/",x)).status===201&&(n.notify({type:"positive",message:"Match gespeichert."}),c("submitted",a.selectedGameId))}catch(b){if(((u=b.response)==null?void 0:u.status)===202){O.value=!0;const f=((R=(C=b.response.data)==null?void 0:C.tied_players)==null?void 0:R.join(", "))||"Unbekannt";n.notify({type:"warning",message:`Unentschieden erkannt zwischen Spielern: ${f}. Bitte Tie-Breaker Werte eingeben.`})}else(p=(Q=b.response)==null?void 0:Q.data)!=null&&p.detail?n.notify({type:"negative",message:b.response.data.detail}):(console.error("Fehler beim Senden:",b),n.notify({type:"negative",message:"Unbekannter Fehler beim Speichern."}))}}return(x,u)=>(i(),G(me,{class:"q-pa-md",flat:"",bordered:"",rounded:""},{default:y(()=>[L("div",en,[m.value.length?(i(),G(ia,{key:0,onSubmit:Vt(_,["prevent"])},{default:y(()=>[L("div",tn,[(i(!0),N(te,null,ne(I(l),(C,R)=>(i(),N("div",{key:C.id,class:"col-3"},[q(me,{class:"shadow-1 rounded-borders"},{default:y(()=>{var Q,p,b;return[L("div",{class:be(["form-card-header q-pa-sm text-white text-subtitle2 text-center",C.colorClass])},Y(C.username),3),L("div",an,[(Q=g.value)!=null&&Q.has_points?(i(),G(De,{key:0,modelValue:m.value[R].points,"onUpdate:modelValue":f=>m.value[R].points=f,modelModifiers:{number:!0},type:"number",inputmode:"numeric",label:"Points",dense:"",outlined:"",rules:[f=>f!==null||"Pflichtfeld"]},null,8,["modelValue","onUpdate:modelValue","rules"])):D("",!0),nn,L("div",ln,[(p=g.value)!=null&&p.has_starting_player_order?(i(),G(gt,{key:0,flat:"",class:"q-gutter-x-xs"},{default:y(()=>[(i(!0),N(te,null,ne(I(l).length,f=>(i(),G(Te,{flat:"",key:f,label:f,"text-color":m.value[R].starting_position===f?"secondary":"grey-4",dense:"",onClick:P=>m.value[R].starting_position=f},null,8,["label","text-color","onClick"]))),128))]),_:2},1024)):D("",!0)]),(b=g.value)!=null&&b.is_asymmetric?(i(),G(na,{key:1,modelValue:m.value[R].faction_id,"onUpdate:modelValue":f=>m.value[R].faction_id=f,options:k.value,"option-label":"name","option-value":"id",label:"Faction",dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue","options"])):D("",!0),O.value?(i(),G(De,{key:2,modelValue:m.value[R].tie_breaker_value,"onUpdate:modelValue":f=>m.value[R].tie_breaker_value=f,label:"Tie-Breaker Wert",dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])):D("",!0)])]}),_:2},1024)]))),128))]),L("div",on,[q(Te,{type:"submit",label:"Ergebnisse speichern",color:"primary",unelevated:""})])]),_:1})):(i(),G(Qt,{key:1,color:"primary",size:"md",class:"q-my-xl"}))])]),_:1}))}});var rn=ke(sn,[["__scopeId","data-v-538c876c"]]);const un=["top","middle","bottom"];var Qe=fe({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>un.includes(e)}},setup(e,{slots:s}){const c=w(()=>e.align!==void 0?{verticalAlign:e.align}:null),n=w(()=>{const a=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(a!==void 0?` text-${a}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>T("div",{class:n.value,style:c.value,role:"status","aria-label":e.label},ut(s.default,e.label!==void 0?[e.label]:[]))}});const cn=e=>(ct("data-v-cad5a624"),e=e(),dt(),e),dn={class:"selected-game-card"},mn={key:0,class:"game-container"},fn={class:"column"},vn={class:"row items-center no-wrap"},gn={class:"text-subtitle1 text-weight-medium"},_n={class:"row items-center q-gutter-xs q-mb-xs q-mr-xs"},hn=cn(()=>L("div",{class:"text-caption text-weight-medium"},"Banned by",-1)),bn={key:0,class:"row"},pn={class:"text-left text-weight-medium"},yn={class:"text-right"},wn={key:0,class:"text-primary"},xn=le({__name:"SelectedGameInfo",props:{member:{},isBannable:{type:Function}},setup(e){const s=e,c=re(),{members:n,leagueId:a,membersById:l}=ie(c);We();const g=E(!1);function k(o){return o.id!=null}const m=w(()=>{var o,d;return(d=(o=s.member.selected_game)==null?void 0:o.id)!=null?d:null}),O=w(()=>{const o=m.value;return o?n.value.filter(d=>d.banned_game&&k(d.banned_game)&&d.banned_game.id===o).map(d=>{var v;return{username:d.username,colorClass:(v=d.colorClass)!=null?v:"bg-grey-2"}}):[]});return(o,d)=>(i(),N("div",dn,[o.member.selected_game?(i(),N("div",mn,[L("div",{class:be(["card-header row items-start justify-between",{"cursor-pointer":o.isBannable(o.member)}])},[L("div",fn,[L("div",vn,[L("div",gn,Y(o.member.selected_game.game_name),1)]),q(me,{flat:"",class:"q-mt-sm row q-pa-sm bg-grey-1"},{default:y(()=>[L("div",_n,[q(K,{name:"block",size:"18px",class:"text-negative"}),hn]),O.value.length?(i(),N("div",bn,[(i(!0),N(te,null,ne(O.value,v=>(i(),G(ua,{key:v.id,username:v.username,"color-class":v.colorClass},null,8,["username","color-class"]))),128))])):D("",!0)]),_:1})]),q(Te,{flat:"",round:"",size:"sm",icon:"expand_more",class:be(["transition-all",{"rotate-180":g.value}]),onClick:d[0]||(d[0]=v=>g.value=!g.value),color:"primary"},null,8,["class"])],2),g.value?(i(),G(he,{key:0,class:"card-body"},{default:y(()=>[q(Be,{spaced:""}),q(ra,{flat:"",bordered:"",dense:"",class:"rounded-borders"},{default:y(()=>[L("tbody",null,[(i(!0),N(te,null,ne(o.member.selected_game.selected_options,v=>(i(),N("tr",{key:v.id},[L("td",pn,Y(v.game_option.name),1),L("td",yn,[v.choice?(i(),N("span",wn,Y(v.choice.name),1)):v.value===!0?(i(),G(K,{key:1,name:"check_circle",color:"positive"})):v.value===!1?(i(),G(K,{key:2,name:"cancel",color:"negative"})):(i(),G(K,{key:3,name:"help_outline",color:"grey"}))])]))),128))])]),_:1})]),_:1})):D("",!0)])):D("",!0)]))}});var kn=ke(xn,[["__scopeId","data-v-cad5a624"]]);const Sn={class:"row items-center no-wrap"},qn={class:"text-subtitle2 text-weight-medium"},In={class:"row items-center q-gutter-xs no-wrap"},Cn=le({__name:"PlayerCard",props:{member:{}},setup(e){const{leagueStatus:s,isMeActivePlayer:c}=ie(re());function n(l){return s.value==="BANNING"&&c.value&&!l.is_active_player}function a(l){return s.value==="BANNING"&&l.is_active_player}return(l,g)=>(i(),G(me,{flat:"",bordered:"",class:"q-ma-sm rounded-borders"},{default:y(()=>[q(he,{class:be(["row justify-between items-center text-white",l.member.colorClass])},{default:y(()=>[L("div",Sn,[L("span",qn,Y(l.member.username),1),l.member.is_active_player?(i(),G(Qe,{key:0,rounded:"",color:"primary","text-color":"white",class:"q-ml-sm"},{default:y(()=>[q(K,{name:"circle",size:"10px",class:"q-mr-xs"}),se(" Active ")]),_:1})):D("",!0)]),L("div",In,[l.member.selected_game?(i(),G(Qe,{key:0,color:"white",outline:""},{default:y(()=>[q(K,{name:"sports_esports",size:"14px",class:"q-mr-xs"}),se(" Game ")]),_:1})):D("",!0),l.member.banned_game?(i(),G(Qe,{key:1,color:"white",outline:""},{default:y(()=>[q(K,{name:"block",size:"14px",class:"q-mr-xs"}),se(" Ban ")]),_:1})):D("",!0)])]),_:1},8,["class"]),q(he,{class:"q-pa-sm bg-grey-1"},{default:y(()=>[q(kn,{member:l.member,isBannable:n,isBanning:a},null,8,["member"])]),_:1})]),_:1}))}});var Ce=fe({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:s}){const c=Ge(),n=w(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return T("td",{class:n.value},xe(s.default));const a=c.vnode.key,l=(e.props.colsMap!==void 0?e.props.colsMap[a]:null)||e.props.col;if(l===void 0)return;const{row:g}=e.props;return T("td",{class:n.value+l.__tdClass(g),style:l.__tdStyle(g)},xe(s.default))}}});const $n={class:"row items-center justify-around q-mb-md"},Tn={class:"text-h6 text-primary"},Bn={key:0,class:"text-caption text-grey-7"},Ln=le({__name:"MatchResult",props:{selectedGameId:{}},setup(e){const s=e,c=re(),{matchResultsByGame:n,membersById:a,selectedGamesById:l}=ie(c),g=w(()=>{var o,d;return(d=(o=l.value[s.selectedGameId])==null?void 0:o.game_name)!=null?d:null}),k=w(()=>{var o;return(o=n.value[s.selectedGameId])!=null?o:[]}),m=w(()=>k.value.map(o=>{var v,_,x,u,C;const d=a.value[o.player_profile];return{id:o.id,username:(v=d==null?void 0:d.username)!=null?v:`#${o.player_profile}`,colorClass:(_=d==null?void 0:d.colorClass)!=null?_:"bg-grey-2",points:(x=o.points)!=null?x:null,starting_position:(u=o.starting_position)!=null?u:null,faction_name:(C=o.faction_name)!=null?C:null}})),O=[{name:"player",label:"",field:"username",align:"left"},{name:"points",label:"",field:"points",align:"center"},{name:"starting_position",label:"",field:"starting_position",align:"center"},{name:"faction_name",label:"",field:"faction_name",align:"center"}];return(o,d)=>(i(),G(me,{flat:"",class:""},{default:y(()=>{var v;return[L("div",$n,[L("div",Tn,Y((v=g.value)!=null?v:"\u2014"),1)]),m.value.length===0?(i(),N("div",Bn,"Noch keine Ergebnisse.")):(i(),G(vt,{key:1,flat:"",dense:"",rows:m.value,columns:O,"row-key":"id","hide-bottom":""},{"body-cell-player":y(_=>[q(Ce,{props:_},{default:y(()=>[q(we,{class:be(_.row.colorClass)},{default:y(()=>[se(Y(_.row.username),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"header-cell-points":y(_=>[q(Oe,{props:_,class:"text-center"},{default:y(()=>[q(K,{name:"star",size:"sm"})]),_:2},1032,["props"])]),"body-cell-points":y(_=>[q(Ce,{props:_},{default:y(()=>[_.row.points!=null?(i(),G(we,{key:0,dense:"",square:"",color:"grey-3","text-color":"black",label:_.row.points},null,8,["label"])):D("",!0)]),_:2},1032,["props"])]),"header-cell-starting_position":y(_=>[q(Oe,{props:_,class:"text-center"},{default:y(()=>[q(K,{name:"flag",size:"sm"})]),_:2},1032,["props"])]),"body-cell-starting_position":y(_=>[q(Ce,{props:_},{default:y(()=>[_.row.starting_position?(i(),G(we,{key:0,dense:"",square:"",color:"grey-2","text-color":"black",label:_.row.starting_position},null,8,["label"])):D("",!0)]),_:2},1032,["props"])]),"header-cell-faction_name":y(_=>[q(Oe,{props:_,class:"text-center"},{default:y(()=>[q(K,{name:"diversity_2",size:"sm"})]),_:2},1032,["props"])]),"body-cell-faction_name":y(_=>[q(Ce,{props:_},{default:y(()=>[_.row.faction_name?(i(),G(we,{key:0,dense:"",square:"",color:"indigo-1","text-color":"indigo-10",label:_.row.faction_name},null,8,["label"])):D("",!0)]),_:2},1032,["props"])]),_:1},8,["rows"]))]}),_:1}))}}),Gn=L("div",{class:"row items-center justify-center"},[L("div",{class:"text-h6 text-primary"},"League Standings")],-1),Rn=le({__name:"LeagueStandings",setup(e){const{matchResultsByGame:s,membersById:c}=ie(re()),n=w(()=>{var g;const l={};for(const k in s.value){const m=[...(g=s.value[k])!=null?g:[]];if(m.length===0)continue;m.sort((o,d)=>{var v,_;return((v=d.points)!=null?v:-9999)-((_=o.points)!=null?_:-9999)});const O=[6,3,1,0];m.forEach((o,d)=>{var x,u;const v=c.value[o.player_profile],_=(x=v==null?void 0:v.username)!=null?x:`#${o.player_profile}`;l[o.player_profile]||(l[o.player_profile]={id:o.player_profile,league_player:_,league_points:0,wins:0}),l[o.player_profile].league_points+=(u=O[d])!=null?u:0,d===0&&(l[o.player_profile].wins+=1)})}return Object.values(l).sort((k,m)=>m.league_points!==k.league_points?m.league_points-k.league_points:m.wins-k.wins)}),a=[{name:"league_player",label:"Player",field:"league_player",align:"left"},{name:"league_points",label:"League Points",field:"league_points",align:"center"},{name:"wins",label:"Wins",field:"wins",align:"center"}];return(l,g)=>(i(),G(me,{flat:""},{default:y(()=>[Gn,q(vt,{flat:"",rows:n.value,columns:a,"row-key":"id","hide-bottom":""},null,8,["rows"])]),_:1}))}});const Pn={class:"row no-wrap q-pa-xs"},An={class:"row justify-center"},Mn=le({__name:"MyLeagueResults",setup(e){const{selectedGamesWithResults:s}=ie(re());return(c,n)=>(i(),N("div",Pn,[L("div",An,[(i(!0),N(te,null,ne(I(s),a=>(i(),G(Ln,{key:a.id,"selected-game-id":a.id},null,8,["selected-game-id"]))),128))]),q(Rn,{class:"q-ml-auto"})]))}});var Nn=ke(Mn,[["__scopeId","data-v-75058cd8"]]),En=fe({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:s,emit:c}){let n=!1,a,l,g=null,k=null,m,O;function o(){a&&a(),a=null,n=!1,g!==null&&(clearTimeout(g),g=null),k!==null&&(clearTimeout(k),k=null),l!==void 0&&l.removeEventListener("transitionend",m),m=null}function d(u,C,R){C!==void 0&&(u.style.height=`${C}px`),u.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,n=!0,a=R}function v(u,C){u.style.overflowY=null,u.style.height=null,u.style.transition=null,o(),C!==O&&c(C)}function _(u,C){let R=0;l=u,n===!0?(o(),R=u.offsetHeight===u.scrollHeight?0:void 0):(O="hide",u.style.overflowY="hidden"),d(u,R,C),g=setTimeout(()=>{g=null,u.style.height=`${u.scrollHeight}px`,m=Q=>{k=null,(Object(Q)!==Q||Q.target===u)&&v(u,"show")},u.addEventListener("transitionend",m),k=setTimeout(m,e.duration*1.1)},100)}function x(u,C){let R;l=u,n===!0?o():(O="show",u.style.overflowY="hidden",R=u.scrollHeight),d(u,R,C),g=setTimeout(()=>{g=null,u.style.height=0,m=Q=>{k=null,(Object(Q)!==Q||Q.target===u)&&v(u,"hide")},u.addEventListener("transitionend",m),k=setTimeout(m,e.duration*1.1)},100)}return Le(()=>{n===!0&&o()}),()=>T(jt,{css:!1,appear:e.appear,onEnter:_,onLeave:x},s.default)}});const _e=Ft({}),On=Object.keys(mt);var Vn=fe({name:"QExpansionItem",props:{...mt,...Dt,...Ut,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:Number,headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...zt,"click","afterShow","afterHide"],setup(e,{slots:s,emit:c}){const{proxy:{$q:n}}=Ge(),a=Wt(e,n),l=E(e.modelValue!==null?e.modelValue:e.defaultOpened),g=E(null),k=Fe(),{show:m,hide:O,toggle:o}=Ht({showing:l});let d,v;const _=w(()=>`q-expansion-item q-item-type q-expansion-item--${l.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),x=w(()=>{if(e.contentInsetLevel===void 0)return null;const S=n.lang.rtl===!0?"Right":"Left";return{["padding"+S]:e.contentInsetLevel*56+"px"}}),u=w(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),C=w(()=>{const S={};return On.forEach(H=>{S[H]=e[H]}),S}),R=w(()=>u.value===!0||e.expandIconToggle!==!0),Q=w(()=>e.expandedIcon!==void 0&&l.value===!0?e.expandedIcon:e.expandIcon||n.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),p=w(()=>e.disable!==!0&&(u.value===!0||e.expandIconToggle===!0)),b=w(()=>({expanded:l.value===!0,detailsId:e.targetUid,toggle:o,show:m,hide:O})),f=w(()=>{const S=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:n.lang.label[l.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":l.value===!0?"true":"false","aria-controls":k,"aria-label":S}});oe(()=>e.group,S=>{v!==void 0&&v(),S!==void 0&&ae()});function P(S){u.value!==!0&&o(S),c("click",S)}function A(S){S.keyCode===13&&t(S,!0)}function t(S,H){H!==!0&&g.value!==null&&g.value.focus(),o(S),je(S)}function $(){c("afterShow")}function J(){c("afterHide")}function ae(){d===void 0&&(d=Fe()),l.value===!0&&(_e[e.group]=d);const S=oe(l,ge=>{ge===!0?_e[e.group]=d:_e[e.group]===d&&delete _e[e.group]}),H=oe(()=>_e[e.group],(ge,Re)=>{Re===d&&ge!==void 0&&ge!==d&&O()});v=()=>{S(),H(),_e[e.group]===d&&delete _e[e.group],v=void 0}}function B(){const S={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},H=[T(K,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&l.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:Q.value})];return p.value===!0&&(Object.assign(S,{tabindex:0,...f.value,onClick:t,onKeyup:A}),H.unshift(T("div",{ref:g,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),T(Ee,S,()=>H)}function j(){let S;return s.header!==void 0?S=[].concat(s.header(b.value)):(S=[T(Ee,()=>[T(st,{lines:e.labelLines},()=>e.label||""),e.caption?T(st,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&S[e.switchToggleSide===!0?"push":"unshift"](T(Ee,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>T(K,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&S[e.switchToggleSide===!0?"unshift":"push"](B()),S}function U(){const S={ref:"item",style:e.headerStyle,class:e.headerClass,dark:a.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return R.value===!0&&(S.clickable=!0,S.onClick=P,Object.assign(S,u.value===!0?C.value:f.value)),T(la,S,j)}function ee(){return rt(T("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:x.value,id:k},xe(s.default)),[[Kt,l.value]])}function ve(){const S=[U(),T(En,{duration:e.duration,onShow:$,onHide:J},ee)];return e.expandSeparator===!0&&S.push(T(Be,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:a.value}),T(Be,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:a.value})),S}return e.group!==void 0&&ae(),Le(()=>{v!==void 0&&v()}),()=>T("div",{class:_.value},[T("div",{class:"q-expansion-item__container relative-position"},ve())])}});const Qn={class:"full-width row justify-center items-center"},jn={class:"q-pa-md"},$e=le({__name:"ContentSection",props:Yt({title:{},color:{},defaultOpen:{type:Boolean,default:!0}},{isOpened:{type:Boolean},isOpenedModifiers:{}}),emits:["update:isOpened"],setup(e){const s=Jt(e,"isOpened"),n=E(e.defaultOpen),a=w({get:()=>{var l;return(l=s.value)!=null?l:n.value},set:l=>{s.value===void 0?n.value=l:s.value=l}});return(l,g)=>(i(),N("div",{class:"rounded-borders q-my-xs",style:Zt(`border: 3px solid var(--q-${l.color})`)},[q(Vn,{modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=k=>a.value=k),"dense-toggle":"","expand-separator":"","expand-icon":"expand_more","expanded-icon":"expand_less","expand-icon-class":"text-white","expanded-icon-class":"text-white","header-class":`bg-${l.color} text-white text-h5 q-py-xs justify-center`},{header:y(()=>[L("div",Qn,Y(l.title),1)]),default:y(()=>[L("div",jn,[Xt(l.$slots,"default")])]),_:3},8,["modelValue","header-class"])],4))}}),Fn={class:"row q-col-gutter-md q-pa-md"},al=le({__name:"MyLeague",setup(e){const s=re();Ue(()=>{s.init()});const{isMePickingGame:c,isMeBanningGame:n,leagueStatus:a,selectedGamesFetchedEmpty:l,selectedGamesById:g,members:k,leagueId:m}=ie(s),{updateLeagueData:O,refreshResultsForGame:o}=s,{setActions:d,setLeadText:v,reset:_}=He(),{user:x}=We(),u=E(null);function C(f){u.value=null,o(f)}v("Select a game to ban"),d(Object.values(g.value).filter(f=>f.selected_by!==(x==null?void 0:x.username)).map(f=>({name:`${f.game_name}`,buttonVariant:"accent",callback:()=>p(f.id,f.game_name)}))),oe(n,()=>{n.value&&m.value&&x.username&&(v("Select a game to ban"),d(Object.values(g.value).filter(f=>f.selected_by!==(x==null?void 0:x.username)).map(f=>({name:`${f.game_name}`,buttonVariant:"primary",callback:()=>p(f.id,f.game_name),autoReset:!1}))))});const{setDialog:R}=ca(),Q=ft();function p(f,P){const A="warning";R("Confirm Ban",`Are you sure you want to ban ${P.toUpperCase()}?`,A,async()=>{try{await _t({leagueId:m.value,username:x.username,gameId:f}),await O(),Q.notify({type:A,message:"Banned!"})}catch(t){console.log("Could not ban game",t)}finally{_()}},()=>{console.log("Ban cancelled")},"Ban")}const b=E({selection:!0,upload:!1,results:!1,players:!0});return ea(()=>{switch(a.value){case"PLAYING":b.value.upload=!0,b.value.results=!0;break;case"DONE":b.value.results=!0;break;case"BANNING":b.value.selection=!1,b.value.players=!0;break;case"PICKING":case"REPICKING":b.value.selection=!0;break}}),(f,P)=>(i(),N("div",null,[q(Xa),I(c)?(i(),G($e,{key:0,title:"Game Selection",color:"positive","is-opened":b.value.selection},{default:y(()=>[q(Ea,{onSubmitSuccess:I(O),class:"q-mt-md q-pa-xs"},null,8,["onSubmitSuccess"])]),_:1},8,["is-opened"])):D("",!0),I(a)==="PLAYING"?(i(),N(te,{key:1},[q($e,{title:"Upload Results",color:"accent","is-opened":b.value.upload},{default:y(()=>[q(ba,{"active-color":"primary","indicator-color":"primary",modelValue:u.value,"onUpdate:modelValue":P[0]||(P[0]=A=>u.value=A)},{default:y(()=>[(i(!0),N(te,null,ne(I(l),A=>(i(),G(ga,{key:A.id,name:A.id},{default:y(()=>[se(Y(A.game_name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),u.value?(i(),G(rn,{key:0,onSubmitted:C,"selected-game-id":u.value},null,8,["selected-game-id"])):D("",!0)]),_:1},8,["is-opened"]),I(a)==="PLAYING"?(i(),G($e,{key:0,title:"Results",color:"positive","is-opened":b.value.results},{default:y(()=>[q(Nn)]),_:1},8,["is-opened"])):D("",!0)],64)):D("",!0),q($e,{title:"Players",color:"primary","is-opened":b.value.players},{default:y(()=>[L("div",Fn,[(i(!0),N(te,null,ne(I(k),A=>(i(),N("div",{key:A.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[q(Cn,{member:A},null,8,["member"])]))),128))])]),_:1},8,["is-opened"])]))}});export{al as default};
