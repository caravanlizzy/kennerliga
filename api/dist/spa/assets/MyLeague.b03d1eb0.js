import{k as C,b as D,aR as I,aS as T,ar as v,p as M,h as p,y as L,e as z,m as A,o as i,A as c,F as l,a as u,w as Q,c as O,V as B,ah as G,aa as q,a9 as P,C as r,af as S,D as E,z as F,_ as N,O as j,ae as R}from"./index.9a6af9dc.js";import{Q as W}from"./QInput.2425900d.js";import{Q as Y}from"./QToggle.1309c8b6.js";import{_ as U}from"./KennerSelect.67eb17a3.js";import{_ as H}from"./KennerButton.95e53cea.js";import"./reponsive.47e55779.js";import"./use-checkbox.20d24288.js";import"./QSelect.815809a5.js";import"./scroll.e98cb3f3.js";const J=[C("circle",{cx:"50",cy:"50",r:"44",fill:"none","stroke-width":"4","stroke-opacity":".5",stroke:"currentColor"}),C("circle",{cx:"8",cy:"54",r:"6",fill:"currentColor","stroke-width":"3",stroke:"currentColor"},[C("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 48",to:"360 50 52",dur:"2s",repeatCount:"indefinite"})])];var K=D({name:"QSpinnerOrbit",props:I,setup(a){const{cSize:o,classes:s}=T(a);return()=>C("svg",{class:s.value,width:o.value,height:o.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},J)}});async function X(a){console.log({selectedGame:a});try{await v("/game/selected-games/",{method:"POST",data:{game:a.game,selected_options:a.selected_options}})}catch(o){throw new Error("Error creating selectedGame"+o)}}async function Z(a){try{return await v(`/game/options/?game=${a}`)}catch(o){throw new Error(`Error retrieving game options for game with id: ${a} 
 ${o}`)}}async function ee(a){try{return await v(`/game/option-choices/?option=${a}`)}catch(o){throw new Error(`Error retrieving game option choices for game with id: ${a} 
 ${o}`)}}function te(){const a=M({game:void 0,options:[]}),o=p(!1),s=M({game:0,selectedOptions:[]});async function f(e){a.game&&a.game.id===e.id||(o.value=!0,g(e),await x(e.id),await _(),o.value=!1)}function g(e){y(e),d(e)}function y(e){a.game=e,a.options=[]}function d(e){s.game=e,s.selectedOptions=[]}function b(e){console.log(s.game.id);const t={id:e.id,selected_game:s.game.id,value:e.has_choices?void 0:!1,choice:void 0};s.selectedOptions.push(t)}async function x(e){try{const{data:t}=await Z(e);a.options=t,t.forEach(b)}catch(t){console.error(`Failed to fetch options for game ${e}:`,t),a.options=[]}}async function _(){for(const e of a.options){if(!e.has_choices)continue;const{data:t}=await ee(e.id);e.choices=[...e.choices||[],...t]}}function m(e){var t;return((t=a.options.find(n=>n.id===e))==null?void 0:t.choices)||null}async function w(){const{data:e}=await v("game/platforms/");return e}async function k(){const{data:e}=await v("game/games/");return e}function V(e){const t=e.selectedOptions.map(n=>n.choice?(console.log({option:n}),{game_option:n.id,choice:n.choice.id}):{game_option:n.id,value:n.value});return console.log({selectedOptions:t}),{game:e.game.id,selected_options:t}}function h(){if(s){const e=V(s);console.log({data:e}),X(e)}else console.warn("No game selected")}return{gameInformation:a,gameSelection:s,isLoading:o,setGameInformation:f,findChoicesByOption:m,fetchPlatforms:w,fetchGames:k,submitGame:h}}const ae=l("div",{class:"text-h6"},"W\xE4hle dein Spiel",-1),oe={class:"row"},se={class:"row games-container q-mt-lg"},ne=["onClick"],ie={key:0},re={key:1,class:"q-py-md q-my-md"},ce={class:"text-h6"},le={key:0,class:"text-italic"},de=L({__name:"GameSelector",setup(a){const{gameInformation:o,gameSelection:s,isLoading:f,setGameInformation:g,findChoicesByOption:y,fetchPlatforms:d,fetchGames:b,submitGame:x}=te(),_=p(),m=p(""),w=p([]),k=p([]);z(async()=>{w.value=await d(),k.value=await b()});const V=A(()=>k.value.filter(h=>(!_.value||h.platform===_.value.id)&&(!m.value||h.name.toLowerCase().includes(m.value.toLowerCase()))));return(h,e)=>(i(),c("div",null,[ae,l("div",oe,[u(U,{class:"select-width q-mr-md",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),"option-value":"name","option-label":"name",options:w.value,label:"Platform"},null,8,["modelValue","options"]),u(W,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),label:"Spiel"},{append:Q(()=>[m.value?(i(),O(B,{key:0,name:"close",onClick:e[1]||(e[1]=t=>m.value=""),class:"cursor-pointer"})):G("",!0),u(B,{name:"search"})]),_:1},8,["modelValue"])]),l("div",se,[(i(!0),c(q,null,P(V.value,t=>(i(),c("div",{key:t.id,onClick:n=>r(g)(t)},[l("div",{class:E([{selected:r(o).game&&t.id===r(o).game.id},"q-px-lg q-py-md game-selection-element cursor-pointer"])},S(t.name.toUpperCase()),3)],8,ne))),128))]),r(f)?(i(),c("div",ie,[u(K,{size:"xl"})])):r(o).game?(i(),c("div",re,[l("span",ce,S(r(o).game.name),1),r(o).options.length?(i(!0),c(q,{key:1},P(r(o).options,t=>(i(),c("div",{key:t.id,class:"q-py-sm"},[t.has_choices?(i(),O(U,{key:0,options:r(y)(t.id),label:t.name,"option-label":"name",modelValue:r(s).selectedOptions.find(n=>n.id==t.id).choice,"onUpdate:modelValue":n=>r(s).selectedOptions.find($=>$.id==t.id).choice=n,class:"select-width inline-block"},null,8,["options","label","modelValue","onUpdate:modelValue"])):(i(),O(Y,{key:1,modelValue:r(s).selectedOptions.find(n=>n.id==t.id).value,"onUpdate:modelValue":n=>r(s).selectedOptions.find($=>$.id==t.id).value=n,label:t.name},null,8,["modelValue","onUpdate:modelValue","label"]))]))),128)):(i(),c("div",le,"Spiel hat keine weiteren Optionen"))])):G("",!0),u(H,{onClick:r(x),type:"submit",push:"",color:"positive",label:"Speichern",class:"q-mt-md"},null,8,["onClick"])]))}});const me={class:"row justify-between q-px-md q-py-sm"},ue=L({__name:"PlayerOrderList",setup(a){const{isMe:o}=F(),s=[{name:"haligh",game:"Terra Mystica"},{name:"isiundossi",game:"Gaia Project"},{name:"Ginooo",game:"7 Wonders"},{name:"MissM",game:"Automobiles"}],f=p("isiundossi");return(g,y)=>(i(),c("div",me,[(i(),c(q,null,P(s,d=>l("div",{key:d.name,class:"q-mr-lg row"},[l("div",{class:E({"active-player":f.value===d.name})},[l("div",{class:E({isMeClass:r(o)(d.name)})},S(d.name),3),l("div",null,S(d.game),1)],2)])),64))]))}});var pe=N(ue,[["__scopeId","data-v-0fda952e"]]);const fe={},_e={class:"q-pa-md"};function he(a,o){return i(),c("div",_e,[j(a.$slots,"default")])}var ve=N(fe,[["render",he]]);const ge={class:"q-pa-lg"},ye={class:"gradient"},Ge=L({__name:"MyLeague",setup(a){const o=p(!0);return(s,f)=>(i(),c("div",ge,[l("div",ye,[u(ve,null,{default:Q(()=>[R(" Pending...")]),_:1}),u(pe,{class:"bg-grey-2"})]),o.value?(i(),O(de,{key:0,class:"q-mt-lg"})):G("",!0)]))}});export{Ge as default};
